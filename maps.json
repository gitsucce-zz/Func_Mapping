{"RandomStr": {"fp": "/Users/virink/www/function.php", "fr": "", "fa": ["$len=16"], "fb": "\r\n        $chars = \"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789\";\r\n        $random = '';\r\n        for($i = 0; $i < $len; $i++){\r\n            $random .= $chars[rand(0, strlen($chars)-1)];\n        ", "ff": {"1": "rand", "2": "strlen"}, "fl": 11}, "get": {"fp": "/Users/virink/www/config.php", "fr": "$row", "fa": ["$sql"], "fb": "\r\n            $result = $this->query($sql);\r\n            if($result){\r\n                $row = mysqli_fetch_object($result);\r\n                return $row;\r\n            ", "ff": {"1": "query", "2": "mysqli_fetch_object"}, "fl": 55}, "waf": {"fp": "/Users/virink/www/config.php", "fr": "", "fa": ["$data"], "fb": "\r\n            if(get_magic_quotes_gpc()){\r\n                $data = stripcslashes($data);\r\n            ", "ff": {"1": "get_magic_quotes_gpc", "2": "stripcslashes"}, "fl": 41}, "htmlfilter": {"fp": "/Users/virink/www/function.php", "fr": "$pureHtml", "fa": ["$str"], "fb": "\r\n        $pureHtml = htmlentities($str, ENT_QUOTES,'UTF-8');\r\n        return $pureHtml;\r\n    ", "ff": {"1": "htmlentities"}, "fl": 57}, "auth": {"fp": "/Users/virink/www/function.php", "fr": "$res->userid", "fa": ["$username", "$password"], "fb": "\r\n        global $user;\n        $sql = \"select * from user where username='\".$username.\"'\";\r\n        $res = $user->get($sql);\r\n        if($res){\r\n            if(hash_equals($res->password, md5($password.$res->salt))){\r\n                return $res->userid;\r\n            ", "ff": {"1": "get", "2": "hash_equals", "3": "md5"}, "fl": 38}, "hash_equals": {"fp": "/Users/virink/www/function.php", "fr": "", "fa": ["$known_string", "$user_string"], "fb": "\r\n            $ret = 0;\r\n            if (strlen($known_string) !== strlen($user_string)) {\r\n                $user_string = $known_string;\r\n                $ret = 1;\r\n            ", "ff": {"1": "strlen"}, "fl": 22}, "init": {"fp": "/Users/virink/www/config.php", "fr": "", "fa": [], "fb": "\r\n            $this->conn = mysqli_connect($this->db_host, $this->db_user, $this->db_pass) or die('connect db error');\r\n            mysqli_select_db($this->conn, $this->db_database) or die('select db error');\r\n            mysqli_set_charset($this->conn ,'utf8');\r\n        ", "ff": {"1": "mysqli_connect", "2": "mysqli_select_db", "3": "mysqli_set_charset"}, "fl": 35}, "query": {"fp": "/Users/virink/www/config.php", "fr": "$this->result", "fa": ["$sql"], "fb": "\r\n            $this->sql = $sql;\r\n            $this->result = mysqli_query($this->conn,$sql);\r\n            return $this->result;\r\n        ", "ff": {"1": "mysqli_query", "2": "query"}, "fl": 49}, "BlockAttacker": {"fp": "/Users/virink/www/function.php", "fr": "", "fa": ["$strFiltKey", "$strFiltValue"], "fb": "\r\n\r\n        $filter = \"\\\\<.+javascript:window\\\\[.{1", "ff": {}, "fl": 63}, "find": {"fp": "/Users/virink/www/config.php", "fr": "", "fa": ["$sql", "$key=null"], "fb": "\r\n            $res = array();\r\n            $this->result = $this->query($sql);\r\n            while($row = mysqli_fetch_object($this->result)){\r\n                if(!empty($key)){\r\n                    $res[$row->{$key", "ff": {"1": "query", "2": "mysqli_fetch_object"}, "fl": 66}, "__construct": {"fp": "/Users/virink/www/config.php", "fr": "", "fa": ["$db_host", "$db_user", "$db_pass", "$db_database"], "fb": "\r\n            $this->db_host = $db_host;\r\n            $this->db_user = $db_user;\r\n            $this->db_pass = $db_pass;\r\n            $this->db_database = $db_database;\r\n            $this->init();\r\n        ", "ff": {"1": "init"}, "fl": 27}}